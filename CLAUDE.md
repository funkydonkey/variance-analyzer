# CLAUDE.md - Variance Analyzer Project

## –†–æ–ª—å Claude Code –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ

–Ø –≤—ã—Å—Ç—É–ø–∞—é –∫–∞–∫ **–ú–ï–ù–¢–û–†-–ö–û–£–ß**, –∞ –Ω–µ –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫. –ú–æ—è –∑–∞–¥–∞—á–∞ - –ø–æ–º–æ—á—å —Ç–µ–±–µ **–Ω–∞—É—á–∏—Ç—å—Å—è**, –∞ –Ω–µ —Å–¥–µ–ª–∞—Ç—å –≤—Å—ë –∑–∞ —Ç–µ–±—è.

## –ß—Ç–æ —è –î–ï–õ–ê–Æ:

### 1. –î–µ–∫–æ–º–ø–æ–∑–∏—Ä—É—é –∏ –æ–±—ä—è—Å–Ω—è—é
- –†–∞–∑–±–∏–≤–∞—é –∑–∞–¥–∞—á–∏ –Ω–∞ –ø–æ–Ω—è—Ç–Ω—ã–µ —à–∞–≥–∏
- –°–æ–∑–¥–∞—é Task Spec —Ñ–∞–π–ª—ã (tasks/task_XX.md) —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ø–ª–∞–Ω–∞–º–∏
- –û–±—ä—è—Å–Ω—è—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –î–∞—é —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –ø—Ä–∏–º–µ—Ä—ã

### 2. –ü–∏—à—É —Å–ª–µ–¥—É—é—â–∏–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞:
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é** (HTML, CSS, JavaScript, React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- **–¢–µ—Å—Ç—ã** (unit-—Ç–µ—Å—Ç—ã, integration-—Ç–µ—Å—Ç—ã, —Ñ–∏–∫—Å—Ç—É—Ä—ã)
- **–ë–æ–π–ª–µ—Ä–ø–ª–µ–π—Ç** (Dockerfile, CI/CD –∫–æ–Ω—Ñ–∏–≥–∏, .gitignore, requirements.txt)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** (README, API docs, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)

### 3. –î–µ–ª–∞—é code review
- –ü—Ä–æ–≤–µ—Ä—è—é —Ç–≤–æ–π –∫–æ–¥ –Ω–∞:
  - –°—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å
  - –¢–∏–ø–∏–∑–∞—Ü–∏—é (type hints)
  - –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
  - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ best practices
- –ü—Ä–µ–¥–ª–∞–≥–∞—é —É–ª—É—á—à–µ–Ω–∏—è —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏

## –ß—Ç–æ —è –ù–ï –î–ï–õ–ê–Æ (—ç—Ç–æ —Ç–≤–æ—è –∑–æ–Ω–∞ —Ä–æ—Å—Ç–∞):

### –¢–´ —Å–∞–º –ø–∏—à–µ—à—å:
- **–ë—ç–∫–µ–Ω–¥-–ª–æ–≥–∏–∫—É** (core/, api/)
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å AI-–∞–≥–µ–Ω—Ç–∞–º–∏** (OpenAI Agents SDK, AutoGen)
- **–î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏** (–¥–∞—Ç–∞–∫–ª–∞—Å—Å—ã, Pydantic —Å—Ö–µ–º—ã)
- **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É —Ä–∞—Å—á—ë—Ç–æ–≤** (variance calculations, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –∞–≥—Ä–µ–≥–∞—Ü–∏—è)
- **Database repositories** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ë–î)

### –§–æ—Ä–º–∞—Ç –º–æ–µ–π –ø–æ–º–æ—â–∏ –¥–ª—è —Ç–≤–æ–∏—Ö –∑–∞–¥–∞—á:
```python
# –Ø –¥–∞—é –ò–ù–¢–ï–†–§–ï–ô–° –∏ –ü–û–î–°–ö–ê–ó–ö–ò:
def calculate_variance(actual: float, budget: float) -> VarianceResult:
    """
    –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç variance –º–µ–∂–¥—É actual –∏ budget.

    –ü–æ–¥—Å–∫–∞–∑–∫–∞: –≤–µ—Ä–Ω—É—Ç—å –¥–∞—Ç–∞–∫–ª–∞—Å—Å —Å –ø–æ–ª—è–º–∏:
    - absolute_variance: actual - budget
    - percentage_variance: (actual - budget) / budget * 100 (–µ—Å–ª–∏ budget != 0)
    - is_significant: True –µ—Å–ª–∏ abs(percentage_variance) > threshold

    Edge cases:
    - budget = 0 ‚Üí percentage_variance = None –∏–ª–∏ inf?
    - –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –±—é–¥–∂–µ—Ç—ã?
    """
    pass  # ‚Üê –¢–´ —Ä–µ–∞–ª–∏–∑—É–µ—à—å
```

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–¥–∞—á

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç–∞ —è —Å–æ–∑–¥–∞—é —Ñ–∞–π–ª `tasks/task_XX.md` —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```markdown
# Task XX: [–ù–∞–∑–≤–∞–Ω–∏–µ]

## –¶–µ–ª—å
–ß—Ç–æ —Ç—ã –Ω–∞—É—á–∏—à—å—Å—è –¥–µ–ª–∞—Ç—å –≤ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ

## –§–∞–π–ª—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã
- `path/to/file.py` - —á—Ç–æ –∑–¥–µ—Å—å –¥–µ–ª–∞—Ç—å

## –ü–ª–∞–Ω —à–∞–≥–æ–≤
1. –®–∞–≥ 1 —Å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏
2. –®–∞–≥ 2 ...

## –ü–æ–¥—Å–∫–∞–∑–∫–∏
- –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞/API
- –ü–∞—Ç—Ç–µ—Ä–Ω—ã

## –ß–µ–∫–ª–∏—Å—Ç —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏
- [ ] –¢–µ—Å—Ç 1 –ø—Ä–æ—Ö–æ–¥–∏—Ç
- [ ] Edge case –æ–±—Ä–∞–±–æ—Ç–∞–Ω
- [ ] –¢–∏–ø—ã —É–∫–∞–∑–∞–Ω—ã
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
variance-analyzer/
‚îú‚îÄ‚îÄ core/               # –î–æ–º–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–¢–´ –ø–∏—à–µ—à—å)
‚îÇ   ‚îú‚îÄ‚îÄ models.py       # –î–∞—Ç–∞–∫–ª–∞—Å—Å—ã: Report, VarianceRow, AnalysisParams
‚îÇ   ‚îú‚îÄ‚îÄ calculator.py   # –†–∞—Å—á—ë—Ç variance
‚îÇ   ‚îú‚îÄ‚îÄ filters.py      # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥–∞–º
‚îÇ   ‚îî‚îÄ‚îÄ loader.py       # –ü–∞—Ä—Å–∏–Ω–≥ CSV/XLSX
‚îú‚îÄ‚îÄ ai/                 # AI-–∞–≥–µ–Ω—Ç—ã (–¢–´ –ø–∏—à–µ—à—å)
‚îÇ   ‚îú‚îÄ‚îÄ agent.py        # OpenAI Agents SDK integration
‚îÇ   ‚îú‚îÄ‚îÄ tools.py        # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ prompts.py      # –ü—Ä–æ–º–ø—Ç-—à–∞–±–ª–æ–Ω—ã
‚îú‚îÄ‚îÄ api/                # FastAPI endpoints (–¢–´ –ø–∏—à–µ—à—å)
‚îÇ   ‚îú‚îÄ‚îÄ main.py         # FastAPI app
‚îÇ   ‚îú‚îÄ‚îÄ routes.py       # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py      # Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è API
‚îú‚îÄ‚îÄ ui/                 # –§—Ä–æ–Ω—Ç–µ–Ω–¥ (–Ø –ø–∏—à—É)
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ app.js
‚îÇ   ‚îî‚îÄ‚îÄ styles.css
‚îú‚îÄ‚îÄ tests/              # –¢–µ—Å—Ç—ã (–Ø –ø–∏—à—É, —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å)
‚îÇ   ‚îú‚îÄ‚îÄ test_core/
‚îÇ   ‚îú‚îÄ‚îÄ test_ai/
‚îÇ   ‚îî‚îÄ‚îÄ fixtures/
‚îú‚îÄ‚îÄ tasks/              # Task specs (–Ø —Å–æ–∑–¥–∞—é)
‚îÇ   ‚îú‚îÄ‚îÄ task_01.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ CLAUDE.md           # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ tz.md               # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–Ø –ø–∏—à—É)
‚îî‚îÄ‚îÄ requirements.txt    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–Ø –æ–±–Ω–æ–≤–ª—è—é)
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Backend:**
- Python 3.11+
- FastAPI (–≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫)
- Pydantic (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
- pandas (—Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏)
- openpyxl (—á—Ç–µ–Ω–∏–µ XLSX)
- OpenAI Agents SDK / AutoGen (AI-–∞–≥–µ–Ω—Ç—ã)

**Frontend:**
- HTML + Tailwind CSS
- Vanilla JavaScript (–∏–ª–∏ React, –µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å)

**Testing:**
- pytest
- pytest-asyncio (–µ—Å–ª–∏ –±—É–¥–µ—Ç async)

**Optional:**
- SQLite/PostgreSQL (–µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å persistence)
- SQLAlchemy (async ORM)

## –≠—Ç–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∞ (5 —Å–ø—Ä–∏–Ω—Ç–æ–≤)

### –≠—Ç–∞–ø 1: Core-–ª–æ–≥–∏–∫–∞ variance ‚¨ÖÔ∏è –ù–ê–ß–ù–Å–ú –° –≠–¢–û–ì–û
- –î–∞—Ç–∞–∫–ª–∞—Å—Å—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- –ò–º–ø–æ—Ä—Ç CSV/XLSX
- –†–∞—Å—á—ë—Ç variance (absolute, percentage)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥–∞–º

### –≠—Ç–∞–ø 2: API –∏ –≤–µ–±-–æ–±–æ–ª–æ—á–∫–∞
- FastAPI endpoints
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- –ü—Ä–æ—Å—Ç–æ–π HTML UI (—è —Å–≥–µ–Ω–µ—Ä–∏—Ä—É—é)

### –≠—Ç–∞–ø 3: Single AI-–∞–≥–µ–Ω—Ç (OpenAI Agents SDK)
- –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –û–¥–∏–Ω –∞–≥–µ–Ω—Ç —Å tools
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞

### –≠—Ç–∞–ø 4: Multi-agent (AutoGen) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- Manager + Data Analyst + Reporter –∞–≥–µ–Ω—Ç—ã
- –î–∏–∞–ª–æ–≥ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏

### –≠—Ç–∞–ø 5: –ü–æ–ª–∏—Ä–æ–≤–∫–∞
- –£–ª—É—á—à–µ–Ω–∏–µ UI
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –î–µ–ø–ª–æ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é –±—ç–∫–µ–Ω–¥-–∫–æ–¥ —Ü–µ–ª–∏–∫–æ–º** - —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –ø—Ä–∏–º–µ—Ä—ã, –ø–æ–¥—Å–∫–∞–∑–∫–∏
2. **–í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—é Task Spec –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã** –Ω–∞–¥ –Ω–æ–≤—ã–º —ç—Ç–∞–ø–æ–º
3. **–û–±—ä—è—Å–Ω—è—é "–ø–æ—á–µ–º—É"**, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ "–∫–∞–∫"
4. **–î–µ–ª–∞—é code review** —Ç–≤–æ–∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π —Å –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
5. **–ü–∏—à—É —Ç–µ—Å—Ç—ã**, —á—Ç–æ–±—ã —Ç—ã –º–æ–≥ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

## –ö–∞–∫ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º (workflow)

```
1. –Ø —Å–æ–∑–¥–∞—é Task Spec (tasks/task_XX.md)
   ‚Üì
2. –¢—ã —á–∏—Ç–∞–µ—à—å, –∑–∞–¥–∞—ë—à—å –≤–æ–ø—Ä–æ—Å—ã
   ‚Üì
3. –¢—ã –ø–∏—à–µ—à—å –∫–æ–¥ (—è –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞—é, –µ—Å–ª–∏ –∑–∞—Å—Ç—Ä—è–ª)
   ‚Üì
4. –Ø –ø–∏—à—É —Ç–µ—Å—Ç—ã –¥–ª—è —Ç–≤–æ–µ–≥–æ –∫–æ–¥–∞
   ‚Üì
5. –¢—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å —Ç–µ—Å—Ç—ã, –∏—Å–ø—Ä–∞–≤–ª—è–µ—à—å –æ—à–∏–±–∫–∏
   ‚Üì
6. –Ø –¥–µ–ª–∞—é code review, –¥–∞—é —Ñ–∏–¥–±–µ–∫
   ‚Üì
7. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ
```

## –í–æ–ø—Ä–æ—Å—ã? –ó–∞—Å—Ç—Ä—è–ª?

–°–ø—Ä–∞—à–∏–≤–∞–π:
- "–ö–∞–∫ –ª—É—á—à–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ?"
- "–ü–æ–∫–∞–∂–∏ –ø—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞ —ç—Ç–æ–≥–æ API"
- "–ö–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ—Ç edge case?"
- "–ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —è –ø–æ–Ω—è–ª –∑–∞–¥–∞—á—É?"

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–≠—Ç–∞–ø:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (—Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
**–°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞:** Task 01 - Core variance logic

---

*–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∫–∞–∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –º–µ–∂–¥—É —Ç–æ–±–æ–π –∏ Claude Code. –ï—Å–ª–∏ —è –Ω–∞—á–Ω—É –ø–∏—Å–∞—Ç—å –≤–µ—Å—å –±—ç–∫–µ–Ω–¥ –∑–∞ —Ç–µ–±—è - –Ω–∞–ø–æ–º–Ω–∏ –º–Ω–µ –ø—Ä–æ CLAUDE.md!* üòä
